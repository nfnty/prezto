#
# Executes commands at the start of an interactive session.
#
# Authors:
#   Sorin Ionescu <sorin.ionescu@gmail.com>
#

# Source Prezto.
if [[ -s "${ZDOTDIR:-$HOME}/.zprezto/init.zsh" ]]; then
  source "${ZDOTDIR:-$HOME}/.zprezto/init.zsh"
fi

# Customize to your needs...

stty -ixoff
stty -ixon

export GPG_TTY="$( tty )"

() {
    if [[ -e "${XDG_DATA_HOME}/ssh/config" ]]; then
        local host
        local IFS=$'\n'
        for host in $( cat "${XDG_DATA_HOME}/ssh/config" | grep '^Host \w\+' | cut --delimiter=' ' --fields=2 ); do
            alias "s${host}"="ssh ${host}"
            alias "m${host}"="sshfs ${host}: /remote/${host} -o dir_cache=no"
            alias "um${host}"="fusermount -u /remote/${host}"
        done
    fi
}

alias rg='rg --smart-case'
alias startx="${XDG_CONFIG_HOME}/xorg/startx"

bindkey -M viins -r -p ''
bindkey -M vicmd -r -p ''
bindkey -M viopp -r -p ''
bindkey -M visual -r -p ''

bindkey -M viins -R '\x1C-\x1F' self-insert
bindkey -M viins '\x20' magic-space
bindkey -M viins -R '\x21-\x7E' self-insert
bindkey -M viins '\x7F' backward-delete-char
bindkey -M viins -R '\x80-\xFF' self-insert

bindkey -M viins '\t' expand-or-complete-with-indicator
bindkey -M viins '\r' accept-line
bindkey -M viins '\e[3~' delete-char
bindkey -M viins '\e[A' history-substring-search-up
bindkey -M viins '\eOA' history-substring-search-up
bindkey -M viins '\e[B' history-substring-search-down
bindkey -M viins '\eOB' history-substring-search-down
bindkey -M viins '\e[C' forward-char
bindkey -M viins '\eOC' forward-char
bindkey -M viins '\e[D' backward-char
bindkey -M viins '\eOD' backward-char
bindkey -M viins '\e[Z' reverse-menu-complete
bindkey -M viins '\e[200~' bracketed-paste
bindkey -M viins '\CD' list-choices
bindkey -M viins '\CA' beginning-of-line
bindkey -M viins '\CE' end-of-line
bindkey -M viins '\CO' edit-command-line
bindkey -M viins '\CL' clear-screen
bindkey -M viins '\CR' redisplay
bindkey -M viins '\CU' vi-kill-line
bindkey -M viins '\CK' kill-line
bindkey -M viins '\CW' vi-backward-kill-word
bindkey -M viins '\CP' expand-cmd-path
